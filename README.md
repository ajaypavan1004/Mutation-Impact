# Mutation Impact  
**Structure- and Conservation-Aware Mutation Feature Extraction**

Mutation Impact is a command-line framework for analysing protein point mutations in structural, evolutionary, and physicochemical context.

Given a protein sequence, structure (mmCIF), and mutation list, it automatically:

- Extracts residue-level structural context (secondary structure, solvent accessibility, burial)
- Computes evolutionary conservation from homologous sequence alignment
- Quantifies physicochemical changes introduced by mutations
- Generates a baseline structural stability risk index
- Exports an ML-ready mutation feature matrix for downstream modeling

Designed for:

- Wet lab scientists who want rapid structural interpretation of mutations  
- Computational researchers preparing mutation datasets for machine learning  

---

## When to Use Mutation Impact

Use this tool when you:

- Have a list of protein point mutations and want structured interpretation
- Need residue-level structural and conservation features
- Want reproducible mutation descriptors for ML workflows
- Require rapid structural stability insight without running full energy-based simulations

Mutation Impact focuses on mutation-level feature extraction and stability estimation.

It does **not** perform structure prediction or physics-based free energy calculations.  
If no experimental structure is available, a predicted structure (e.g., from AlphaFold) can be supplied as input.

---

## Inputs

- Protein FASTA sequence  
- Mutation CSV file (`position, wt, mut`)  
- Protein structure file in **mmCIF format (.cif)**  
- Homolog FASTA file for conservation analysis  

---

## Outputs

### 1. Human-Readable Mutation Analysis  
`final_mutation_analysis.csv`

Includes:

- Secondary structure  
- Relative solvent accessibility  
- Burial flag  
- Conservation score  
- Physicochemical mutation metrics  
- Stability risk index  
- Stability classification  

---

### 2. ML-Ready Feature Matrix  
`mutation_feature_matrix.csv`

Contains structured numeric mutation features suitable for regression or classification models.

This file excludes heuristic stability scoring to prevent target leakage in ML workflows.

---

## Project Structure

```
mutation-impact/
│
├── main.py
├── environment.yml
├── mutation_impact/
│   ├── features.py
│   ├── structure.py
│   ├── conservation.py
│   ├── chemistry.py
│   └── ...
│
├── example/
│   ├── tp53.fasta
│   ├── tp53_homologs.fasta
│   ├── 2OCJ.cif
│   ├── tp53_mutations.csv
│   └── results/
│
└── README.md
```

---

## Installation

Clone the repository:

```bash
git clone https://github.com/YOUR_USERNAME/mutation-impact.git
cd mutation-impact
```

Create the conda environment:

```bash
conda env create -f environment.yml
conda activate mutation-impact
```

---

## Usage

```bash
python main.py \
  --fasta example/tp53.fasta \
  --mutations example/tp53_mutations.csv \
  --structure example/2OCJ.cif \
  --chain A \
  --homologs example/tp53_homologs.fasta \
  --output example/results
```

Output directory:

```
example/results/
├── mutation_feature_matrix.csv
└── final_mutation_analysis.csv
```

---

## Stability Risk Index

The stability risk index integrates:

- Residue burial  
- Conservation  
- Volume change  
- Hydrophobicity change  

It is a **baseline heuristic**, not a trained ΔΔG predictor.

For rigorous thermodynamic predictions, dedicated energy based tools or experimental measurements are recommended.

---

## Using for Machine Learning

The file `mutation_feature_matrix.csv` can be used directly as input to ML models.

Example workflow:

1. Generate mutation features  
2. Merge with experimental labels (e.g., ΔΔG, pathogenicity)  
3. Train regression or classification models  

Example (scikit-learn):

```python
import pandas as pd
from sklearn.ensemble import RandomForestRegressor

df = pd.read_csv("mutation_feature_matrix.csv")

X = df.drop(columns=["experimental_ddg"])
y = df["experimental_ddg"]

model = RandomForestRegressor()
model.fit(X, y)
```

Feature extraction is deterministic and reproducible.

---
## Feature Definitions

Below is a description of key columns generated by Mutation Impact.

### Structural Features

| Column | Description |
|--------|------------|
| `secondary_structure` | Secondary structure assignment from DSSP (H = helix, E = strand, etc.) |
| `relative_sasa` | Relative solvent accessible surface area (0–1 scale) |
| `buried_flag` | 1 if residue is buried (relative_sasa < 0.2), else 0 |

---

### Evolutionary Features

| Column | Description |
|--------|------------|
| `entropy` | Shannon entropy at the mutation position derived from MSA |
| `conservation_score` | Inverse entropy metric scaled for interpretability (higher = more conserved) |

---

### Physicochemical Mutation Features

| Column | Description |
|--------|------------|
| `charge_change` | Net change in residue charge due to mutation |
| `hydrophobicity_delta` | Change in hydrophobicity between wild-type and mutant residue |
| `volume_delta` | Change in side-chain volume (Å³) |
| `polarity_change_flag` | Binary flag indicating polarity change |

---

### Stability Heuristic

| Column | Description |
|--------|------------|
| `stability_risk_index` | Baseline structural risk index derived from structural and physicochemical features |
| `stability_class` | Categorised stability impact (Low, Moderate, High) |

---

## Example Validation

Validated on hotspot mutations in the TP53 DNA-binding domain.

Structural destabilizing mutations are identified as high structural risk, while DNA-contact mutations are differentiated appropriately.

---
